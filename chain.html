<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>BeAPI-API-Framework</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <img src="beapi_logo2.png" style="width:auto;height:auto;">
        <p></p>

        <ul>
          <li><a href="http://orubel.github.io/Beapi-API-Framework/index.html"><strong>Installation</strong></a></li>
            <li><a href="http://orubel.github.io/Beapi-API-Framework/confserv.html"><strong>Configure Server</strong></a></li>
            <li><a href="http://orubel.github.io/Beapi-API-Framework/confdb.html"><strong>Configure Database</strong></a></li>
            <li><a href="http://orubel.github.io/Beapi-API-Framework/confapi.html"><strong>Configure API Application</strong></a></li>
          <li><a href="http://orubel.github.io/Beapi-API-Framework/model.html"><strong>Model/Domain Object</strong></a></li>
            <li><a href="http://orubel.github.io/Beapi-API-Framework/controller.html"><strong>Controller</strong></a></li>
          <li><a href="http://orubel.github.io/Beapi-API-Framework/iostate.html"><strong>IO State</strong></a></li>
            <li><a href="http://orubel.github.io/Beapi-API-Framework/version.html"><strong>Versioning</strong></a></li>
            <li><a href="http://orubel.github.io/Beapi-API-Framework/user.html"><strong>User Management</strong></a></li>
          <li><a href="http://orubel.github.io/Beapi-API-Framework/usage.html"><strong>API Usage</strong></a></li>
          <li><a href="http://orubel.github.io/Beapi-API-Framework/batch.html"><strong>Batch Processing</strong></a></li>
          <li><a href="http://orubel.github.io/Beapi-API-Framework/chain.html"><strong>Api Chaining</strong></a></li>
            <ul>
              <li><a href="chain.html#what">What is API Chaining</a></li>
              <li><a href="chain.html#example">API Chain Examples</a></li>
              <li><a href="chain.html#create">Creating A Chain</a></li>
            </ul>
          </li>
            <li><a href="http://orubel.github.io/Beapi-API-Framework/hook.html"><strong>Web Hooks</strong></a></li>
            <li><a href="http://orubel.github.io/Beapi-API-Framework/ping.html"><strong>PING Architecture</strong></a></li>
            <li><a href="http://orubel.github.io/Beapi-API-Framework/rate.html"><strong>Rate Limiting</strong></a></li>
            <li><a href="http://orubel.github.io/Beapi-API-Framework/docs.html"><strong>API Docs</strong></a></li>
          <li><a href="http://orubel.github.io/Beapi-API-Framework/troubleshooting.html"><strong>Troubleshooting</strong></a></li>
          <li>&nbsp</li>

        </ul>
      </header>
      <section>

          <h1><a id="req" class="anchor" href="#req" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>API Chaining</h1>

</br>
<h3><a id="what" class="anchor" href="#conf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>What Is API Chaining(TM)?</h3>
<p>API Chaining is a process allowing one api call to return data into another api call which returns data into another api call , etc etc, <b>all within ONE REQUEST/RESPONSE</b>. This is allowed through the abstraction of communication logic from business logic through the New API Pattern. This is limited in the fact that you can only use GET method as the connectors in the chain and one other 'non-safe' method (ie PUT/POST/DELETE) at either the beginning or the end of the chain (as determined by the REQUEST method).</p>
<p>NOTE: The API Chaining trademark can only be used by those properly implementing the process</b>. As a process, it is only considered successfully implemented if:
  <li>it MUST use ONLY ONE REQUEST/RESPONSE</li>
  <li>client can create chains and they MUST be processed dynamically; there SHOULD BE NO hardcoded chains.</li>
  <li>there MUST BE no more than ONE non-safe REQUEST method used in a chain during a single REQUEST/RESPONSE</li>
</p>
        
<p>We have all used encoded GET data when sending form data via a POST request. This is considered common practice. Why? Because GET is idempotent and SAFE. Because it is SAFE (meaning it doesn't change data), it is commonly used with other types of requests as a mixed request. This may not be RESTful but it is considered normal and not unsafe. This is what I like to refer to as a single link chain since it has only one link which is the same as it's destination request.</p>

<p>API chaining extends upon this principle in the fact that you can encode GET data in the URL but pass a POST/PUT/DELETE request (much like post GET with a POST form) to chain the request TO or FROM the request method destination link. This can be used to imply GET requests chained TO a final request link (known as a post- chain) or FROM a request link to other implied GET links (known as a pre-chain).</p>

<p>The reason why this is better than practices like HATEOAS/HAL is that it doesn't rely on the link for the relationship... it relies on a common API Object. By relying on a common API Object to handle and validate the request/response and apply rules, links only become a reference point for data.</p>

        <p>For example, when we make our PUT/POST/DELETE requests we can do :</p>
        <ul>
        <li><b>a post-chain request </b>: a GET request that return the data, then specifies the key we wish to pass to the next 'link' in the chain which will make a GET request returning data, etc until the final request method is matched. This can be illustrated as follows:
<pre><code>GET > GET > PUT
</code></pre>
        </li>
        <li><b>a pre-chain request </b>: same as a post chain request except the request method is matched in the beginning and then sends and id to the GET methods after it is called. This can be illustrated as follows:
<pre><code>POST > GET > GET
</code></pre>
          </li>
          <li><b>a blank chain (aka 'GET' chain) </b>: a blank chain has no additional method; it is merely a series of chained GET requests. Basically this takes the returned data from one GET and you give the KEY to get the data for the next GET request in the chain (just like in other chains).
<pre><code>GET > GET > GET
</code></pre>
          </li>
        </ul>
        <p><b>NOTE:</b> Pre and Post chain example can happen with any method including DELETE; A Delete method can delete data or just render it 'inactive' so passing the ID to a GET method afterward can be useful to get related data or to confirm the state.</p>

</br>
<h3><a id="example" class="anchor" href="#conf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>API Chain Examples</h3>
<p><b>POST Post-Chain Example (minus the data)</b></p>
<p>The POST post-chain would be encoded as follows:</p>
<pre><code>{
    ...[your_data_being_sent]...
    chain:{
        key:dept_id,
        combine:'false',
        type:'postchain',
        order:{dept/show:company_id,company/update:return}
    }
}
</code></pre>
<p>And then call via Curl(or via javascript) as follows:</p>
<pre><code>curl -v -H "Content-Type: application/json" -H "Authorization: Bearer [access token]" -X POST -d "{'chain':{'key':'dept_id','combine':'false','type':'postchain','order':{'dept/show':'company_id','company/update':'return'}}}" "http://localhost:8080/v0.1/person/show/1"
</code></pre>
<p>If you need to send Max/Offset variables, do so as follows:</p>
<pre><code>curl -v -H "Content-Type: application/json" -H "Authorization: Bearer [access token]" -X POST -d "{'chain':{'key':'dept_id','combine':'false','type':'postchain','order':{'dept/show':'company_id','company/update':'return'}}}" "http://localhost:8080/v0.1/person/show/1?max=1,1,1&offset=0,0,0"
</code></pre>


</br>
<h3><a id="create" class="anchor" href="#conf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Creating A Chain</h3>
<p>Now lets break down how this call work. Normally you could never pass more than one method but you can URL encode GET data with UNSAFE Methods (PUT, POST, DELETE); now by only using one unsafe method for the call and <b>only one unsafe endpoint</b>, we can send <b>AS MANY GETS in the chain as we want!</b></p>
<p>So the rules of a chain are:
<ul>
          <li>only only PUT,POST or DELETE endpoint</li>
          <li>as many GET endpoint as your hearts content</li>
          <li>the unsafe method (PUT/POST/DELETE) must begin/end the chain</li>
          <li>chains MUST be called using <b>c0.1</b> in the URL for routing purposes</li>
</ul>
</p>
<p>Now lets examine how one of the above chain works:</p>
<ul>
    <li><b><span style="text-decoration: underline;">http://localhost:8080/c0.1/person/show/1</span></b> : initial endpoint that retrieves the initial dataset</li>
    <li><b><span style="text-decoration: underline;">key : dept_id</span></b> : the key to return from the initial dataset to the next iteration in the chain</li>
    <li><b><span style="text-decoration: underline;">combine:false</span></b> : whether to concatenate all data in the chain for return</li>
    <li><b><span style="text-decoration: underline;">type:postchain</span></b> : tells us the location of the unsafe method in the chain for processing; 'postchain' tells us it is at the end, 'prechain' tells us it is at the beginning.</li>
    <li><b><span style="text-decoration: underline;">dept/show : company_id</span></b> : second endpoint iteration; id is the key returned for the next iteration in the chain</li>
    <li><b><span style="text-decoration: underline;">company/update : return</span></b> : As this is the final iteration (and this is a post chain), we return from the chain here</li>
</ul>
<p>So given the chain above, we can see that the unsafe method(PUT) is at the end of the chain (section/update). We also KNOW that it is there because it was DECLARED as a 'postchain' (rather than 'prechain')</p>
  </section>
      <footer>
        <p class="view"><a href="https://github.com/orubel/Beapi-API-Framework">View the Project on GitHub <small>orubel/Beapi-API-Framework</small></a></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
